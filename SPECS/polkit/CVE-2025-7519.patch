From d5d06dbd69df389868a23454e2e44f6d0392fe3a Mon Sep 17 00:00:00 2001
From: Madhur Aggarwal <madaggarwal@microsoft.com>
Date: Thu, 24 Jul 2025 11:39:49 +0000
Subject: [PATCH] Patch CVE-2025-7519

Upstream Patch Reference: https://github.com/polkit-org/polkit/commit/107d3801361b9f9084f78710178e683391f1d245
---
 src/polkitbackend/polkitbackendactionpool.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/src/polkitbackend/polkitbackendactionpool.c b/src/polkitbackend/polkitbackendactionpool.c
index 3894fe9..c9fa23e 100644
--- a/src/polkitbackend/polkitbackendactionpool.c
+++ b/src/polkitbackend/polkitbackendactionpool.c
@@ -672,6 +672,12 @@ _start (void *data, const char *el, const char **attr)
   guint num_attr;
   ParserData *pd = data;
 
+  if (pd->stack_depth < 0 || pd->stack_depth >= PARSER_MAX_DEPTH)
+    {
+      g_warning ("XML parsing reached max depth?");
+      goto error;
+    }
+
   for (num_attr = 0; attr[num_attr] != NULL; num_attr++)
     ;
 
-- 
2.45.4

